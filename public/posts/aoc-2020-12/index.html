<!doctype html>

<html lang="en">

<head>
  <title>Mailund on the Internet</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="Thomas Mailund" />
  

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

<link rel="stylesheet" type="text/css" href="https://mailund.dk/css/styles.css" />
<link rel="stylesheet" href="https://cdn.rawgit.com/tonsky/FiraCode/1.205/distr/fira_code.css">

 
       <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Droid Sans" type="text/css" media="all" />
     
       <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Fira Mono" type="text/css" media="all" />
     

 <style>
 body {
     font-family: 'Droid Sans';
 }
 code {
    font-family: 'Fira Code';
 }
 </style>

 <script type="text/javascript" async
   src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
   MathJax.Hub.Queue(function() {
     
     
     
     var all = MathJax.Hub.getAllJax(), i;
     for(i = 0; i < all.length; i += 1) {
         all[i].SourceElement().parentNode.className += ' has-jax';
     }
   });

   MathJax.Hub.Config({
   
   TeX: { equationNumbers: { autoNumber: "AMS" } }
   });
   MathJax.Hub.Config({
   tex2jax: {
     inlineMath: [['$$','$$'], ['\\(','\\)']],
     displayMath: [['$$$','$$$']],
     processEscapes: true,
     processEnvironments: true,
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
     TeX: { equationNumbers: { autoNumber: "AMS" },
          extensions: ["AMSmath.js", "AMSsymbols.js"] }
   }
   });
 </script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-10582357-1', 'auto');
ga('send', 'pageview');
</script>

</head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://mailund.dk/">Mailund on the Internet</a>
            </h1>

      <ul id="social-media">
        
        <li><a href="https://twitter.com/ThomasMailund"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://www.linkedin.com/in/thomas-mailund-94153b1"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://github.com/mailund"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a></li>
          
        <li><a href="https://www.facebook.com/mailund"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
          
        <li><a href="https://patreon.com/mailund"><i class="fab fa-patreon fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://www.goodreads.com/author/show/15484380.Thomas_Mailund"><i class="fab fa-goodreads fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://www.stackoverflow.com/users/2170269/thomas-mailund"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a></li>
        
      </ul>
      
      <p><em>On Writing, Science, Programming and more</em></p>
      

    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://mailund.dk/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://mailund.dk/posts">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://mailund.dk/books/">
                <i class="fa-li fa  fa-lg"></i><span>Books</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://mailund.dk/publications/">
                <i class="fa-li fa  fa-lg"></i><span>Publications</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://mailund.dk/software/">
                <i class="fa-li fa  fa-lg"></i><span>Software</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>Advent of Code 2020 â€” day 24 remade</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-12-25T07:21:59&#43;01:00">Dec 25, 2020</time>
        </li>
        
        
        <li>
            Categories: 
            <em>
                
                    
                    <a href="https://mailund.dk/categories/programming/">Programming</a>
                
            </em>
        </li>
        

        
        <li>
            <em>
                
                    
                    <a href="https://mailund.dk/tags/python/">#python</a>
                
                    , 
                    <a href="https://mailund.dk/tags/programming/">#programming</a>
                
            </em>
        </li>
        

        <li>3 min read</li>
    </ul>
</aside>
    

    <p>I wanted to get back to yesterdayâ€™s puzzle, and I have a little time before I need to run offâ€¦</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Yes, I was fed up with manual parsing of strings so decided to do it using the re module for once. :p<br><br>I will have a look at your cleaned code for sure. Enjoy the day. ðŸ¥³</p>&mdash; Yassine Alouini (@YassineAlouini) <a href="https://twitter.com/YassineAlouini/status/1342090691992838144?ref_src=twsrc%5Etfw">December 24, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>The use of <code>findall()</code> I refer to in the tweet is this. You can split the input using a regular expression, and then map each input code to a direction. If you combine that with a <code>reduce()</code> you get a very succinct parser:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">f = open(<span style="color:#00f">&#39;/Users/mailund/Projects/adventofcode/2020/24/input.txt&#39;</span>)
tiles = f.read().strip().split()

DIRECTIONS = {
    <span style="color:#00f">&#39;ne&#39;</span>:  <span style="color:#00f">1</span> + <span style="color:#00f">1j</span>,
    <span style="color:#00f">&#39;e&#39;</span>:   <span style="color:#00f">2</span>,
    <span style="color:#00f">&#39;se&#39;</span>:  <span style="color:#00f">1</span> - <span style="color:#00f">1j</span>,
    <span style="color:#00f">&#39;sw&#39;</span>: -<span style="color:#00f">1</span> - <span style="color:#00f">1j</span>,
    <span style="color:#00f">&#39;w&#39;</span>:  -<span style="color:#00f">2</span>,
    <span style="color:#00f">&#39;nw&#39;</span>: -<span style="color:#00f">1</span> + <span style="color:#00f">1j</span>
}

<span style="color:#000080;font-weight:bold">import</span> re
<span style="color:#000080;font-weight:bold">from</span> functools <span style="color:#000080;font-weight:bold">import</span> reduce

<span style="color:#000080;font-weight:bold">def</span> tile_location(tile):
    <span style="color:#000080;font-weight:bold">return</span> reduce(
        <span style="color:#000080;font-weight:bold">lambda</span> x, y: x + DIRECTIONS[y],
        re.findall(<span style="color:#00f">r</span><span style="color:#00f">&#39;(ne|e|se|sw|w|nw)&#39;</span>, tile),
        <span style="color:#00f">0</span>
    )</code></pre></div>
<p>That piece I am shamelessly stealing. It is much nicer than my <a href="https://mailund.dk/posts/aoc-2020-10/">original code</a>.</p>

<p>To continue solving Puzzle #1 (again), to compute the black tiles, we need the tiles that have been flipped an odd number of times. The way I used a set earlier is smarter than the code belowâ€”it is a little easier to read and a lot fasterâ€”but this was a fun way to do it:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080;font-weight:bold">from</span> collections <span style="color:#000080;font-weight:bold">import</span> Counter

<span style="color:#000080;font-weight:bold">def</span> flip_tiles(tiles):
    counts = Counter(tiles)
    <span style="color:#000080;font-weight:bold">return</span> { tile <span style="color:#000080;font-weight:bold">for</span> tile <span style="font-weight:bold">in</span> counts <span style="color:#000080;font-weight:bold">if</span> counts[tile] % <span style="color:#00f">2</span> }</code></pre></div>
<p>And that is all it takes to solve Puzzle #1:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tiles = flip_tiles(map(tile_location, tiles))
<span style="color:#000080;font-weight:bold">print</span>(f<span style="color:#00f">&#34;Puzzle #1: {len(tiles)}&#34;</span>)</code></pre></div>
<p>For Puzzle #2, I had a class for tracking the floor, but since I was only keeping track of the black tiles anyway, I might as well solve everything with set operations. With a few helper functions, we can navigate the floor from the black tiles:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080;font-weight:bold">def</span> neighbours(tile):
    <span style="color:#000080;font-weight:bold">return</span> { tile + n <span style="color:#000080;font-weight:bold">for</span> n <span style="font-weight:bold">in</span> DIRECTIONS.values() }
<span style="color:#000080;font-weight:bold">def</span> black_neighbours(tile, black):
    <span style="color:#000080;font-weight:bold">return</span> len(black &amp; neighbours(tile))

<span style="color:#000080;font-weight:bold">def</span> black_tiles(tiles):
    <span style="color:#000080;font-weight:bold">return</span> tiles
<span style="color:#000080;font-weight:bold">def</span> white_tiles(tiles):
    <span style="color:#000080;font-weight:bold">return</span> set.union( *({ x <span style="color:#000080;font-weight:bold">for</span> x <span style="font-weight:bold">in</span> neighbours(tile) <span style="color:#000080;font-weight:bold">if</span> x <span style="font-weight:bold">not</span> <span style="font-weight:bold">in</span> tiles }
                        <span style="color:#000080;font-weight:bold">for</span> tile <span style="font-weight:bold">in</span> tiles) )</code></pre></div>
<p>When updating the floor, there are black tiles we need to remove and white tiles we need to add (by flipping them to black), and it is a simple case of mapping through the black and white tiles to compute a set of tiles to remove and a set of tiles to add:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080;font-weight:bold">def</span> update(tiles):
    to_remove = {
        b <span style="color:#000080;font-weight:bold">for</span> b <span style="font-weight:bold">in</span> black_tiles(tiles)
          <span style="color:#000080;font-weight:bold">if</span> <span style="font-weight:bold">not</span> (<span style="color:#00f">1</span> &lt;= black_neighbours(b, tiles) &lt;= <span style="color:#00f">2</span>)
    }
    to_add = {
        w <span style="color:#000080;font-weight:bold">for</span> w <span style="font-weight:bold">in</span> white_tiles(tiles)
          <span style="color:#000080;font-weight:bold">if</span> black_neighbours(w, tiles) == <span style="color:#00f">2</span>
    }
    tiles.difference_update(to_remove)
    tiles.update(to_add)

<span style="color:#000080;font-weight:bold">def</span> evolve(tiles, n):
    <span style="color:#000080;font-weight:bold">for</span> _ <span style="font-weight:bold">in</span> range(n):
        update(tiles)
    <span style="color:#000080;font-weight:bold">return</span> tiles</code></pre></div>
<p>And that solves Puzzle #2.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080;font-weight:bold">print</span>(f<span style="color:#00f">&#34;Puzzle #2: {len(evolve(tiles, 100))}&#34;</span>)</code></pre></div>

</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://mailund.dk/posts/aoc-2020-11/"><i class="fa fa-chevron-circle-left"></i> Advent of Code 2020 â€” day 25</a>
        </li>
        
        
        <li>
            <a href="https://mailund.dk/posts/crt-go/">Chinese Remainder in Go <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    
        <section class="comments-block">
      <button id="show-comments" style="display: none;"><i class="fa fa-comments-o"></i> Add/View Comments</button>
</section>

<section id="disqus_thread"></section>

<script>
      (function () {
            
            
            if (window.location.hostname == "localhost")
                  return;

            var disqus_loaded = false;
            var disqus_shortname = 'mailund-dk';
            var disqus_button = document.getElementById("show-comments");

            disqus_button.style.display = "";
            disqus_button.addEventListener("click", disqus, false);

            function disqus() {

                  if (!disqus_loaded) {
                        disqus_loaded = true;

                        var e = document.createElement("script");
                        e.type = "text/javascript";
                        e.async = true;
                        e.src = "//" + disqus_shortname + ".disqus.com/embed.js";
                        (document.getElementsByTagName("head")[0] ||
                              document.getElementsByTagName("body")[0])
                        .appendChild(e);

                        
                        document.getElementById("show-comments").style.display = "none";
                  }
            }

            
            var hash = window.location.hash.substr(1);
            if (hash.length > 8) {
                  if (hash.substring(0, 8) == "comment-") {
                        disqus();
                  }
            }

            
            if (/bot|google|baidu|bing|msn|duckduckgo|slurp|yandex/i.test(navigator.userAgent)) {
                  disqus();
            }
      })();
</script>
    





</main>
    <footer>
        <h6>Copyright &copy; 2020 - Thomas Mailund |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://mailund.dk/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="https://mailund.dk/js/scripts.js"></script>
</body>
<div id="amzn-assoc-ad-04956520-8388-43ab-9b6e-fbe758d208f8"></div>
<script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=04956520-8388-43ab-9b6e-fbe758d208f8"></script>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</html>
